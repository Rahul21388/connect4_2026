{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../firebase/firestore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":70,"index":230}}],"key":"60dQ79Y07Zpvb/jhn2vZMvpjG1w=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/UserContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"UserProvider\", {\n    enumerable: true,\n    get: function () {\n      return UserProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useUser\", {\n    enumerable: true,\n    get: function () {\n      return useUser;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _firebaseFirestore = require(_dependencyMap[2], \"../firebase/firestore\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const UserContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const USER_STORAGE_KEY = '@connect4_username';\n  const UserProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n\n    // Check for stored username on app load\n    (0, _react.useEffect)(() => {\n      checkStoredUser();\n    }, []);\n    const checkStoredUser = async () => {\n      try {\n        const storedUsername = await AsyncStorage.default.getItem(USER_STORAGE_KEY);\n        if (storedUsername) {\n          const userData = await (0, _firebaseFirestore.getUser)(storedUsername);\n          if (userData) {\n            setUser(userData);\n          } else {\n            // User was deleted from Firebase, clear local storage\n            await AsyncStorage.default.removeItem(USER_STORAGE_KEY);\n          }\n        }\n      } catch (error) {\n        console.error('Error checking stored user:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async username => {\n      try {\n        setIsLoading(true);\n\n        // Check if user exists\n        let userData = await (0, _firebaseFirestore.getUser)(username);\n        if (!userData) {\n          // Create new user\n          userData = await (0, _firebaseFirestore.createUser)(username);\n        }\n\n        // Store username locally\n        await AsyncStorage.default.setItem(USER_STORAGE_KEY, username);\n        setUser(userData);\n        return true;\n      } catch (error) {\n        console.error('Login error:', error);\n        return false;\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        await AsyncStorage.default.removeItem(USER_STORAGE_KEY);\n        setUser(null);\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    const refreshUser = async () => {\n      if (user?.username) {\n        const userData = await (0, _firebaseFirestore.getUser)(user.username);\n        if (userData) {\n          setUser(userData);\n        }\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(UserContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        refreshUser\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 5\n    }, this);\n  };\n  const useUser = () => {\n    const context = (0, _react.useContext)(UserContext);\n    if (context === undefined) {\n      throw new Error('useUser must be used within a UserProvider');\n    }\n    return context;\n  };\n});","lineCount":120,"map":[[13,2,17,0,"Object"],[13,8,17,0],[13,9,17,0,"defineProperty"],[13,23,17,0],[13,24,17,0,"exports"],[13,31,17,0],[14,4,17,0,"enumerable"],[14,14,17,0],[15,4,17,0,"get"],[15,7,17,0],[15,18,17,0,"get"],[15,19,17,0],[16,6,17,0],[16,13,17,0,"UserProvider"],[16,25,17,0],[17,4,17,0],[18,2,17,0],[19,2,95,0,"Object"],[19,8,95,0],[19,9,95,0,"defineProperty"],[19,23,95,0],[19,24,95,0,"exports"],[19,31,95,0],[20,4,95,0,"enumerable"],[20,14,95,0],[21,4,95,0,"get"],[21,7,95,0],[21,18,95,0,"get"],[21,19,95,0],[22,6,95,0],[22,13,95,0,"useUser"],[22,20,95,0],[23,4,95,0],[24,2,95,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,3,0],[28,6,3,0,"_firebaseFirestore"],[28,24,3,0],[28,27,3,0,"require"],[28,34,3,0],[28,35,3,0,"_dependencyMap"],[28,49,3,0],[29,2,3,70],[29,6,3,70,"_reactJsxDevRuntime"],[29,25,3,70],[29,28,3,70,"require"],[29,35,3,70],[29,36,3,70,"_dependencyMap"],[29,50,3,70],[30,2,13,0],[30,8,13,6,"UserContext"],[30,19,13,17],[30,35,13,20],[30,39,13,20,"createContext"],[30,45,13,33],[30,46,13,33,"createContext"],[30,59,13,33],[30,61,13,63,"undefined"],[30,70,13,72],[30,71,13,73],[31,2,15,0],[31,8,15,6,"USER_STORAGE_KEY"],[31,24,15,22],[31,27,15,25],[31,47,15,45],[32,2,17,7],[32,8,17,13,"UserProvider"],[32,20,17,60],[32,23,17,63,"UserProvider"],[32,24,17,64],[33,4,17,66,"children"],[34,2,17,75],[34,3,17,76],[34,8,17,81],[35,4,18,2],[35,10,18,8],[35,11,18,9,"user"],[35,15,18,13],[35,17,18,15,"setUser"],[35,24,18,22],[35,25,18,23],[35,28,18,26],[35,32,18,26,"useState"],[35,38,18,34],[35,39,18,34,"useState"],[35,47,18,34],[35,49,18,52],[35,53,18,56],[35,54,18,57],[36,4,19,2],[36,10,19,8],[36,11,19,9,"isLoading"],[36,20,19,18],[36,22,19,20,"setIsLoading"],[36,34,19,32],[36,35,19,33],[36,38,19,36],[36,42,19,36,"useState"],[36,48,19,44],[36,49,19,44,"useState"],[36,57,19,44],[36,59,19,45],[36,63,19,49],[36,64,19,50],[38,4,21,2],[39,4,22,2],[39,8,22,2,"useEffect"],[39,14,22,11],[39,15,22,11,"useEffect"],[39,24,22,11],[39,26,22,12],[39,32,22,18],[40,6,23,4,"checkStoredUser"],[40,21,23,19],[40,22,23,20],[40,23,23,21],[41,4,24,2],[41,5,24,3],[41,7,24,5],[41,9,24,7],[41,10,24,8],[42,4,26,2],[42,10,26,8,"checkStoredUser"],[42,25,26,23],[42,28,26,26],[42,34,26,26,"checkStoredUser"],[42,35,26,26],[42,40,26,38],[43,6,27,4],[43,10,27,8],[44,8,28,6],[44,14,28,12,"storedUsername"],[44,28,28,26],[44,31,28,29],[44,37,28,35,"AsyncStorage"],[44,49,28,47],[44,50,28,47,"default"],[44,57,28,47],[44,58,28,48,"getItem"],[44,65,28,55],[44,66,28,56,"USER_STORAGE_KEY"],[44,82,28,72],[44,83,28,73],[45,8,29,6],[45,12,29,10,"storedUsername"],[45,26,29,24],[45,28,29,26],[46,10,30,8],[46,16,30,14,"userData"],[46,24,30,22],[46,27,30,25],[46,33,30,31],[46,37,30,31,"getUser"],[46,55,30,38],[46,56,30,38,"getUser"],[46,63,30,38],[46,65,30,39,"storedUsername"],[46,79,30,53],[46,80,30,54],[47,10,31,8],[47,14,31,12,"userData"],[47,22,31,20],[47,24,31,22],[48,12,32,10,"setUser"],[48,19,32,17],[48,20,32,18,"userData"],[48,28,32,26],[48,29,32,27],[49,10,33,8],[49,11,33,9],[49,17,33,15],[50,12,34,10],[51,12,35,10],[51,18,35,16,"AsyncStorage"],[51,30,35,28],[51,31,35,28,"default"],[51,38,35,28],[51,39,35,29,"removeItem"],[51,49,35,39],[51,50,35,40,"USER_STORAGE_KEY"],[51,66,35,56],[51,67,35,57],[52,10,36,8],[53,8,37,6],[54,6,38,4],[54,7,38,5],[54,8,38,6],[54,15,38,13,"error"],[54,20,38,18],[54,22,38,20],[55,8,39,6,"console"],[55,15,39,13],[55,16,39,14,"error"],[55,21,39,19],[55,22,39,20],[55,51,39,49],[55,53,39,51,"error"],[55,58,39,56],[55,59,39,57],[56,6,40,4],[56,7,40,5],[56,16,40,14],[57,8,41,6,"setIsLoading"],[57,20,41,18],[57,21,41,19],[57,26,41,24],[57,27,41,25],[58,6,42,4],[59,4,43,2],[59,5,43,3],[60,4,45,2],[60,10,45,8,"login"],[60,15,45,13],[60,18,45,16],[60,24,45,23,"username"],[60,32,45,39],[60,36,45,62],[61,6,46,4],[61,10,46,8],[62,8,47,6,"setIsLoading"],[62,20,47,18],[62,21,47,19],[62,25,47,23],[62,26,47,24],[64,8,49,6],[65,8,50,6],[65,12,50,10,"userData"],[65,20,50,18],[65,23,50,21],[65,29,50,27],[65,33,50,27,"getUser"],[65,51,50,34],[65,52,50,34,"getUser"],[65,59,50,34],[65,61,50,35,"username"],[65,69,50,43],[65,70,50,44],[66,8,52,6],[66,12,52,10],[66,13,52,11,"userData"],[66,21,52,19],[66,23,52,21],[67,10,53,8],[68,10,54,8,"userData"],[68,18,54,16],[68,21,54,19],[68,27,54,25],[68,31,54,25,"createUser"],[68,49,54,35],[68,50,54,35,"createUser"],[68,60,54,35],[68,62,54,36,"username"],[68,70,54,44],[68,71,54,45],[69,8,55,6],[71,8,57,6],[72,8,58,6],[72,14,58,12,"AsyncStorage"],[72,26,58,24],[72,27,58,24,"default"],[72,34,58,24],[72,35,58,25,"setItem"],[72,42,58,32],[72,43,58,33,"USER_STORAGE_KEY"],[72,59,58,49],[72,61,58,51,"username"],[72,69,58,59],[72,70,58,60],[73,8,59,6,"setUser"],[73,15,59,13],[73,16,59,14,"userData"],[73,24,59,22],[73,25,59,23],[74,8,61,6],[74,15,61,13],[74,19,61,17],[75,6,62,4],[75,7,62,5],[75,8,62,6],[75,15,62,13,"error"],[75,20,62,18],[75,22,62,20],[76,8,63,6,"console"],[76,15,63,13],[76,16,63,14,"error"],[76,21,63,19],[76,22,63,20],[76,36,63,34],[76,38,63,36,"error"],[76,43,63,41],[76,44,63,42],[77,8,64,6],[77,15,64,13],[77,20,64,18],[78,6,65,4],[78,7,65,5],[78,16,65,14],[79,8,66,6,"setIsLoading"],[79,20,66,18],[79,21,66,19],[79,26,66,24],[79,27,66,25],[80,6,67,4],[81,4,68,2],[81,5,68,3],[82,4,70,2],[82,10,70,8,"logout"],[82,16,70,14],[82,19,70,17],[82,25,70,17,"logout"],[82,26,70,17],[82,31,70,29],[83,6,71,4],[83,10,71,8],[84,8,72,6],[84,14,72,12,"AsyncStorage"],[84,26,72,24],[84,27,72,24,"default"],[84,34,72,24],[84,35,72,25,"removeItem"],[84,45,72,35],[84,46,72,36,"USER_STORAGE_KEY"],[84,62,72,52],[84,63,72,53],[85,8,73,6,"setUser"],[85,15,73,13],[85,16,73,14],[85,20,73,18],[85,21,73,19],[86,6,74,4],[86,7,74,5],[86,8,74,6],[86,15,74,13,"error"],[86,20,74,18],[86,22,74,20],[87,8,75,6,"console"],[87,15,75,13],[87,16,75,14,"error"],[87,21,75,19],[87,22,75,20],[87,37,75,35],[87,39,75,37,"error"],[87,44,75,42],[87,45,75,43],[88,6,76,4],[89,4,77,2],[89,5,77,3],[90,4,79,2],[90,10,79,8,"refreshUser"],[90,21,79,19],[90,24,79,22],[90,30,79,22,"refreshUser"],[90,31,79,22],[90,36,79,34],[91,6,80,4],[91,10,80,8,"user"],[91,14,80,12],[91,16,80,14,"username"],[91,24,80,22],[91,26,80,24],[92,8,81,6],[92,14,81,12,"userData"],[92,22,81,20],[92,25,81,23],[92,31,81,29],[92,35,81,29,"getUser"],[92,53,81,36],[92,54,81,36,"getUser"],[92,61,81,36],[92,63,81,37,"user"],[92,67,81,41],[92,68,81,42,"username"],[92,76,81,50],[92,77,81,51],[93,8,82,6],[93,12,82,10,"userData"],[93,20,82,18],[93,22,82,20],[94,10,83,8,"setUser"],[94,17,83,15],[94,18,83,16,"userData"],[94,26,83,24],[94,27,83,25],[95,8,84,6],[96,6,85,4],[97,4,86,2],[97,5,86,3],[98,4,88,2],[98,24,89,4],[98,28,89,4,"_reactJsxDevRuntime"],[98,47,89,4],[98,48,89,4,"jsxDEV"],[98,54,89,4],[98,56,89,5,"UserContext"],[98,67,89,16],[98,68,89,17,"Provider"],[98,76,89,25],[99,6,89,26,"value"],[99,11,89,31],[99,13,89,33],[100,8,89,35,"user"],[100,12,89,39],[101,8,89,41,"isLoading"],[101,17,89,50],[102,8,89,52,"login"],[102,13,89,57],[103,8,89,59,"logout"],[103,14,89,65],[104,8,89,67,"refreshUser"],[105,6,89,79],[105,7,89,81],[106,6,89,81,"children"],[106,14,89,81],[106,16,90,7,"children"],[107,4,90,15],[108,6,90,15,"fileName"],[108,14,90,15],[108,16,90,15,"_jsxFileName"],[108,28,90,15],[109,6,90,15,"lineNumber"],[109,16,90,15],[110,6,90,15,"columnNumber"],[110,18,90,15],[111,4,90,15],[111,11,91,26],[111,12,91,27],[112,2,93,0],[112,3,93,1],[113,2,95,7],[113,8,95,13,"useUser"],[113,15,95,20],[113,18,95,23,"useUser"],[113,19,95,23],[113,24,95,46],[114,4,96,2],[114,10,96,8,"context"],[114,17,96,15],[114,20,96,18],[114,24,96,18,"useContext"],[114,30,96,28],[114,31,96,28,"useContext"],[114,41,96,28],[114,43,96,29,"UserContext"],[114,54,96,40],[114,55,96,41],[115,4,97,2],[115,8,97,6,"context"],[115,15,97,13],[115,20,97,18,"undefined"],[115,29,97,27],[115,31,97,29],[116,6,98,4],[116,12,98,10],[116,16,98,14,"Error"],[116,21,98,19],[116,22,98,20],[116,66,98,64],[116,67,98,65],[117,4,99,2],[118,4,100,2],[118,11,100,9,"context"],[118,18,100,16],[119,2,101,0],[119,3,101,1],[120,0,101,2],[120,3]],"functionMap":{"names":["<global>","UserProvider","useEffect$argument_0","checkStoredUser","login","logout","refreshUser","useUser"],"mappings":"AAA;+DCgB;YCK;GDE;0BEE;GFiB;gBGE;GHuB;iBIE;GJO;sBKE;GLO;CDO;uBOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}